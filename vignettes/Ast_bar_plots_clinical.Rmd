---
title: "Visualizing AST by Carbapenem Resistance from Clinical Data"
output: rmarkdown::html_vignette
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{Visualizing AST by Carbapenem Resistance Genes}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## # Introduction

The `create_ast_barplots_gene()` function generates barplots to visualize **antimicrobial susceptibility test (AST)** patterns for a set of drugs. 
The plots are **faceted by carbapenem resistance status**, which is inferred from the column `Isolate_type` based on the phenotypic data whether the isolates was submitted as carbapenem resistant or senetive.

### Steps Performed by the Function

1. **Subset relevant AST columns** from the input dataset.

2. **Detect the carbapenem resistance indicator** from `Isolate_type` column:
   - **CARBA-R** or **CARBA-S** from column `Ioslate_type`

3. **Generate a stacked bar plot** showing the proportion of **S, I, R** for each antimicrobial.

4. **Facet the plot** by phenotypic carbapenem resistance (**CARBA-R** vs **CARBA-S**).

5. **Save the plot** as a **PNG file** in the specified output directory.

### Usage
```{r eval=FALSE, echo=TRUE, message=FALSE}
#import GenepiK
library(GenepiK)

import_data("~/git_repos/GenepiK/data-raw/rapid_report_dummy_data.csv", "~/git_repos/")
```

```{r eval=FALSE, echo=TRUE, message=FALSE}
#create plot
create_ast_barplot(masterdata, "~/git_repos/GenepiK/test_output/")
```

### AST Barplot Output
This should produce a png file like below in your output folder

```{r echo=FALSE, fig.align='center', out.width='60%'}
knitr::include_graphics("~/git_repos/GenepiK/test_output/ast_barplots_clinical_facet.png")
```
